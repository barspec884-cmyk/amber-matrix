<!DOCTYPE html><html lang='ja'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'><style>
    body { display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; background: #f8f8f8; color: #333; font-family: sans-serif; }
    .admin-panel { background: #fff; padding: 15px; border-radius: 10px; margin: 10px; border: 2px solid #d4af37; width: 95vw; max-width: 600px; box-sizing: border-box; box-shadow: 0 4px 15px rgba(0,0,0,0.1); z-index: 1000; }
    .input-row { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; }
    input { background: #fff; color: #333; border: 1px solid #ccc; padding: 10px; border-radius: 4px; font-size: 16px; width: 140px; }
    .btn-main { background: #d4af37; color: #fff; font-weight: bold; border: none; padding: 10px 20px; border-radius: 4px; font-size: 16px; }

    .matrix-board { 
        position: relative; width: 95vw; height: 95vw; max-width: 600px; max-height: 600px; 
        background-color: white; border: 2px solid #333; margin: 40px auto; overflow: hidden; touch-action: none;
        background-size: 5% 5%; /* 方眼紙 1マス5%  */
        background-image: linear-gradient(to right, #eee 1px, transparent 1px), linear-gradient(to bottom, #eee 1px, transparent 1px);
    }
    .center-line-v { position: absolute; left: 50%; width: 2px; height: 100%; background: #333; transform: translateX(-50%); }
    .center-line-h { position: absolute; top: 50%; width: 100%; height: 2px; background: #333; transform: translateY(-50%); }

    /* ラベル配置：方眼紙デザイン  に完全準拠 */
    .axis-label { position: absolute; font-weight: bold; font-size: 14px; color: #333; pointer-events: none; white-space: nowrap; }
    .label-top { top: -30px; left: 50%; transform: translateX(-50%); }
    .label-bottom { bottom: -30px; left: 50%; transform: translateX(-50%); }
    .label-left { left: -70px; top: 50%; transform: translateY(-50%); }
    .label-right { right: -70px; top: 50%; transform: translateY(-50%); }

    .bottle { position: absolute; transform: translate(-50%, -50%); text-align: center; width: 80px; z-index: 10; transition: opacity 0.2s; }
    .bottle img { width: 100%; height: auto; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2)); }
    .label-tag { display: inline-block; background: rgba(0,0,0,0.7); color: #fff; font-size: 10px; padding: 2px 5px; border-radius: 4px; margin-top: 2px; }

    .drag-target { cursor: move; pointer-events: auto !important; z-index: 100; }
    /* ドラッグ中の演出：少し大きく・透ける・指の少し上に表示  */
    .drag-target:active { opacity: 0.6; transform: translate(-50%, -85%) scale(1.1); }
</style></head><body>

<div class='admin-panel'>
    <div class='input-row'>
        <input type="text" id="in-brand" placeholder="銘柄名を入力">
        <button class="btn-main" onclick="addAndSend()">送信</button>
    </div>
    <div style="font-size:12px; margin-top:8px; text-align:center;">
        横軸 (L/R): <span id="xl-x" style="color:#d4af37; font-weight:bold;">0</span> / 
        縦軸 (S/D): <span id="xl-y" style="color:#d4af37; font-weight:bold;">0</span>
    </div>
</div>

<div class='matrix-board' id="board" onmousemove="drag(event)" onmouseup="stopDrag()" ontouchmove="touchDrag(event)" ontouchend="stopDrag()">
    <div class="center-line-v"></div><div class="center-line-h"></div>
    
    <div class="axis-label label-top">スモーキー (Smoky)</div>
    <div class="axis-label label-bottom">デリケート (Delicate)</div>
    <div class="axis-label label-left">ライト (Light)</div>
    <div class="axis-label label-right">リッチ (Rich)</div>

    <div class='bottle' style='left:50%; top:50%; opacity: 0.5;'>
        <img src='JAPANESE/yamazaki.png'>
        <span class='label-tag'>山崎(基準)</span>
    </div>

    <div id="drag-bottle" class="bottle drag-target" style="left:50%; top:50%;" onmousedown="startDrag(event)" ontouchstart="startDrag(event)">
        <img src="JAPANESE/sample-Bottle.png">
        <span class='label-tag' style="background:#d4af37; color:#000;">★配置</span>
    </div>
</div>

<script>
let isDragging = false, webX = 50, webY = 50;
const GAS_URL = "あなたのGASのURL";

function startDrag(e) { isDragging = true; if(e.cancelable) e.preventDefault(); }
function stopDrag() { isDragging = false; }
function touchDrag(e) { if(isDragging && e.touches.length > 0) updatePos(e.touches[0].clientX, e.touches[0].clientY); }
function drag(e) { if(isDragging) updatePos(e.clientX, e.clientY); }

function updatePos(clientX, clientY) {
    const board = document.getElementById('board'), rect = board.getBoundingClientRect();
    webX = Math.max(0, Math.min(100, (((clientX - rect.left) / rect.width) * 100).toFixed(2)));
    webY = Math.max(0, Math.min(100, (((clientY - rect.top) / rect.height) * 100).toFixed(2)));
    
    document.getElementById('drag-bottle').style.left = webX + '%';
    document.getElementById('drag-bottle').style.top = webY + '%';
    
    // Excel の数値と連動 
    // 右がリッチ(+)、左がライト(-)、上がスモーキー(+)、下がデリケート(-)
    document.getElementById('xl-x').innerText = Math.round(webX - 50);
    document.getElementById('xl-y').innerText = Math.round(50 - webY);
}

function addAndSend() {
    alert("送信機能は GAS の URL を設定すると動作します。\n現在の座標: R/L:" + document.getElementById('xl-x').innerText + " S/D:" + document.getElementById('xl-y').innerText);
}
</script></body></html>